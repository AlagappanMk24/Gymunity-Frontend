<div class="gm-auth">
  <!-- Animated Background -->
  <div class="gm-auth__bg">
    <div class="gm-orb gm-orb--1"></div>
    <div class="gm-orb gm-orb--2"></div>
    <div class="gm-orb gm-orb--3"></div>
    <div class="gm-auth__noise"></div>
  </div>

  <div class="gm-auth__inner">

    <!-- Left Panel -->
    <div class="gm-auth__panel">
      <a routerLink="/landing" class="gm-auth__back">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 5l-7 7 7 7"/></svg>
        Back to home
      </a>

      <div class="gm-auth__brand">
        <div class="gm-auth__brand-icon">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
        </div>
        <span class="gm-auth__brand-name">Gymunity</span>
      </div>

      <div class="gm-auth__panel-content">
        <h1 class="gm-auth__panel-title">
          Secure<br>your<br><em>account.</em>
        </h1>
        <p class="gm-auth__panel-desc">
          Two-factor verification keeps your fitness data and account safe from unauthorized access.
        </p>
      </div>

      <div class="gm-auth__features">
        <div class="gm-auth__feature">
          <div class="gm-auth__feature-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
          </div>
          <div>
            <p class="gm-auth__feature-title">Enhanced Security</p>
            <p class="gm-auth__feature-desc">Two-factor authentication for full account protection</p>
          </div>
        </div>
        <div class="gm-auth__feature">
          <div class="gm-auth__feature-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
          </div>
          <div>
            <p class="gm-auth__feature-title">Secure Access</p>
            <p class="gm-auth__feature-desc">One-time code prevents unauthorized access</p>
          </div>
        </div>
        <div class="gm-auth__feature">
          <div class="gm-auth__feature-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
          </div>
          <div>
            <p class="gm-auth__feature-title">Quick Verification</p>
            <p class="gm-auth__feature-desc">Get verified instantly and start your journey</p>
          </div>
        </div>
      </div>

      <div class="gm-auth__stats">
        <div class="gm-auth__stat">
          <span class="gm-auth__stat-num">500+</span>
          <span class="gm-auth__stat-label">Trainers</span>
        </div>
        <div class="gm-auth__stat-divider"></div>
        <div class="gm-auth__stat">
          <span class="gm-auth__stat-num">50K+</span>
          <span class="gm-auth__stat-label">Members</span>
        </div>
        <div class="gm-auth__stat-divider"></div>
        <div class="gm-auth__stat">
          <span class="gm-auth__stat-num">1K+</span>
          <span class="gm-auth__stat-label">Programs</span>
        </div>
      </div>
    </div>

    <!-- Right Form Panel -->
    <div class="gm-auth__form-panel">
      <div class="gm-auth__mobile-brand">
        <div class="gm-auth__brand-icon gm-auth__brand-icon--sm">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
        </div>
        <span class="gm-auth__brand-name gm-auth__brand-name--dark">Gymunity</span>
      </div>

      <div class="gm-auth__form-card">
        <!-- Icon header -->
        <div class="gm-otp__icon-wrap">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
        </div>

        <div class="gm-auth__form-header">
          <h2 class="gm-auth__form-title">Verify Your Account</h2>
          <p class="gm-auth__form-subtitle">
            Code sent to <span class="gm-otp__email">{{ email() }}</span>
          </p>
          <p class="gm-otp__purpose">{{ purposeDisplayText() }}</p>
        </div>

        <!-- Timer -->
        <div class="gm-otp__timer" *ngIf="timer() > 0">
          <div class="gm-otp__timer-inner">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
            <span>Code expires in</span>
          </div>
          <span class="gm-otp__timer-val">{{ formatTime(timer()) }}</span>
        </div>
        <div class="gm-otp__timer gm-otp__timer--expired" *ngIf="timer() === 0">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
          Code expired — please request a new one
        </div>

        <form (ngSubmit)="onSubmit()" class="gm-auth__form">

          <!-- OTP digits -->
          <div class="gm-field">
            <label class="gm-field__label">6-digit Verification Code</label>
            <div class="gm-otp__digits">
              <input
                *ngFor="let i of [0,1,2,3,4,5]; let idx = index"
                #otpInput
                type="text"
                maxlength="1"
                inputmode="numeric"
                pattern="[0-9]*"
                autocomplete="one-time-code"
                (input)="onOtpInput($event, idx)"
                (keydown)="onOtpKeyDown($event, idx)"
                (focus)="onOtpFocus($event, idx)"
                (paste)="onOtpPaste($event)"
                class="gm-otp__digit"
                [class.gm-otp__digit--filled]="otpDigits[idx]"
                [class.gm-otp__digit--error]="messageType() === 'error' && message()"
                [class.gm-otp__digit--success]="messageType() === 'success' && message()"
              />
            </div>
          </div>

          <!-- Message -->
          <div class="gm-alert gm-alert--error" *ngIf="message() && messageType() === 'error'">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="flex-shrink:0"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
            {{ message() }}
          </div>
          <div class="gm-alert gm-alert--success" *ngIf="message() && messageType() === 'success'">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="flex-shrink:0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            {{ message() }}
          </div>

          <!-- Submit -->
          <button
            type="submit"
            class="gm-submit"
            [class.gm-submit--loading]="isLoading()"
            [disabled]="isLoading() || !isOtpComplete() || timer() === 0"
          >
            <span *ngIf="!isLoading()" class="gm-submit__content">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
              {{ getSubmitButtonText() }}
            </span>
            <span *ngIf="isLoading()" class="gm-submit__loading">
              <span class="gm-submit__spinner"></span>
              Verifying…
            </span>
          </button>

          <!-- Resend -->
          <div class="gm-otp__resend">
            <p class="gm-otp__resend-label">Didn't receive the code?</p>
            <button
              type="button"
              (click)="resendOtp()"
              [disabled]="resendDisabled() || isLoading()"
              class="gm-otp__resend-btn"
              [class.gm-otp__resend-btn--disabled]="resendDisabled() || isLoading()"
            >
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 .49-3.5"/></svg>
              {{ getResendButtonText() }}
            </button>
            <p class="gm-otp__resend-timer" *ngIf="resendDisabled() && resendTimer() > 0">
              Available in {{ formatTime(resendTimer()) }}
            </p>
          </div>

        </form>

        <div class="gm-auth__form-footer">
          <p>
            <button type="button" (click)="cancel()" class="gm-auth__form-link">
              ← {{ getCancelButtonText() }}
            </button>
          </p>
          <p style="margin-top:8px">
            Having trouble?
            <a href="mailto:support@gymunity.com" class="gm-auth__form-link">Contact Support</a>
          </p>
        </div>
      </div>
    </div>

  </div>
</div>
